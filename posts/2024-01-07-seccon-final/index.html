<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="caphosra"><meta name=description content="SECCON CTF 2023 Finals DomesticにTSGとして参加したのでwriteupを公開します."><meta name=keywords content="ctf,seccon,seccon 2023,writeup"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://caphosra.net/images/icon.webp"><meta name=twitter:title content="[CTF] SECCON CTF 2023 Finals Domestic writeup"><meta name=twitter:description content="SECCON CTF 2023 Finals DomesticにTSGとして参加したのでwriteupを公開します."><meta property="og:url" content="https://caphosra.net/posts/2024-01-07-seccon-final/"><meta property="og:site_name" content="caphosra note"><meta property="og:title" content="[CTF] SECCON CTF 2023 Finals Domestic writeup"><meta property="og:description" content="SECCON CTF 2023 Finals DomesticにTSGとして参加したのでwriteupを公開します."><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-07T20:14:04+09:00"><meta property="article:modified_time" content="2024-01-07T23:11:13+09:00"><meta property="article:tag" content="CTF"><base href=https://caphosra.net/posts/2024-01-07-seccon-final/><title>[CTF] SECCON CTF 2023 Finals Domestic writeup · caphosra note
</title><link rel=canonical href=https://caphosra.net/posts/2024-01-07-seccon-final/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><style defer>@import 'https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&display=swap'</style><link rel=stylesheet href=https://caphosra.net/css/coder.min.70f3e69b472ec0878dad3a4928700ac7d4dc99e9a09a656210c5862dcf0acfe7.css integrity="sha256-cPPmm0cuwIeNrTpJKHAKx9TcmemgmmViEMWGLc8Kz+c=" crossorigin=anonymous media=screen><script src=https://cdn.jsdelivr.net/npm/gist-embed@1.0.3/dist/gist-embed.min.js defer></script><link rel=icon type=image/png href=https://caphosra.net/images/logo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://caphosra.net/images/logo/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.139.3"><style type=text/css>.icon{font-size:2.5em}</style></head><body class=colorscheme-light><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://caphosra.net/>caphosra note
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://caphosra.net/>About</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/archives/>Archives</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/caphosra>GitHub</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=https://caphosra.net/en/>English</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://caphosra.net/posts/2024-01-07-seccon-final/>[CTF] SECCON CTF 2023 Finals Domestic writeup</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2024-01-07T20:14:04+09:00>1月 7, 2024
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
2分で読めます</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=https://caphosra.net/tags/ctf/>CTF</a></span></div></div></header><div class=post-content><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><p>SECCON CTF 2023の国内決勝にTSGとして参加しました. 1.5問くらい解いたのでwriteupを書きたいと思います.</p><h2 id=reversing-remov>Reversing: ReMOV
<a class=heading-link href=#reversing-remov><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>Reversingの問題. 大量の意味のないmov, movaps命令が並んでいるバイナリが与えられ, そのバイナリが受理するFlagを考えるというもの.</p><p>GhidraでさっとDisassembleして読もうとしたが, 当然まともに読めそうになかったのでgdbで実行しながら怪しい部分を探した. まず, 最初の方は文字列の長さを見て32文字であるかを確認する部分がある. その次に, 文字列の先頭が<code>SECCON{</code>であるかどうかを判定する部分と最後が<code>}</code>で終了しているか確認する部分がある.</p><p>ここまでは, 適当に<code>SECCON{AAA....A}</code>のような長さ32の文字列を与えておけば特に問題はない. さて, ここから引数を8bytesごとにチェックするパートに入る. 具体的には8bytesを切り出して, ある固定値とxorを取ってから別の固定値と比較する操作が4回行われる. 一見, もう一度xorを取ることで容易にFlagを復号できそうだが, このままでは先頭8bytesの値が<code>L\xbd~\xb3HN{y</code>でなければならなくなり, これは先頭8bytesが<code>SECCON{</code>であることと矛盾する.</p><p>もう一度用心深く探ってみると, 途中で不審にptraceを呼んでいる部分がある. これでgdbのようなデバッガーをattachしているかどうか判定し, その返り値によってxorをとる固定値を変更しているようである. そこで, ptraceが呼ばれた後に<code>rax</code>を変えてしまえば問題ないだろうと推測し, 実際うまく行った. 以下のように書けばこれを実現できる.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;b *0x555555555096&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;c&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;set $rax = 0&#39;</span><span style=color:#abb2bf>)</span>
</span></span></code></pre></div><p>実際にその場で書いたソースコードはこんな感じ. 8bytesごとに答えが出てくる.</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8a93a5;font-weight:700;font-style:italic>#!/bin/python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>import</span> <span style=color:#ca72ff>gdb</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>import</span> <span style=color:#ca72ff>re</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>flag</span> <span style=color:#54b1c7>=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;SECCON</span><span style=color:#98c379>{y3t_4n0th3r_m0vfuAAAAAAA}</span><span style=color:#63c381>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;file ./remov&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>o</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#98c379>&#39;starti </span><span style=color:#98c379>{</span><span style=color:#aa89ea>flag</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>decode</span><span style=color:#abb2bf>()</span><span style=color:#98c379>}</span><span style=color:#98c379>&#39;</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>to_string</span><span style=color:#54b1c7>=</span><span style=color:#e5c07b>True</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>o</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;b *0x555555555096&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;b *0x555555555605&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;b *0x555555555637&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;b *0x55555555567d&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;c&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;set $rax = 0&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>current</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>int</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>from_bytes</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>flag</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>0</span><span style=color:#abb2bf>:</span><span style=color:#d19a66>8</span><span style=color:#abb2bf>],</span> <span style=color:#63c381>&#34;little&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>a</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>[]</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>for</span> <span style=color:#aa89ea>i</span> <span style=color:#b756ff;font-weight:700>in</span> <span style=color:#e5c07b>range</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>4</span><span style=color:#abb2bf>):</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;c&#39;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>output1</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>gdb</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>execute</span><span style=color:#abb2bf>(</span><span style=color:#98c379>&#39;reg&#39;</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>to_string</span><span style=color:#54b1c7>=</span><span style=color:#e5c07b>True</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>output1</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>m</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>re</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>search</span><span style=color:#abb2bf>(</span><span style=color:#98c379>r</span><span style=color:#98c379>&#39;(0x.+)&#39;</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>output1</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>a</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>append</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>m</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>group</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0</span><span style=color:#abb2bf>),</span> <span style=color:#d19a66>16</span><span style=color:#abb2bf>))</span>
</span></span><span style=display:flex><span>    <span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;rax: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>a</span><span style=color:#abb2bf>[</span><span style=color:#aa89ea>i</span><span style=color:#abb2bf>])</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>current</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>current</span> <span style=color:#54b1c7>^</span> <span style=color:#abb2bf>(</span><span style=color:#aa89ea>a</span><span style=color:#abb2bf>[</span><span style=color:#aa89ea>i</span><span style=color:#abb2bf>]</span> <span style=color:#54b1c7>&lt;&lt;</span> <span style=color:#abb2bf>(</span><span style=color:#d19a66>0x8</span> <span style=color:#54b1c7>*</span> <span style=color:#aa89ea>i</span><span style=color:#abb2bf>))</span>
</span></span><span style=display:flex><span>    <span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;check: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>current</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>assert</span> <span style=color:#e5c07b>len</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>a</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>==</span> <span style=color:#d19a66>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>e1</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0xbde671e813ba0ec4</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>e2</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0xfe313878bfd3832a</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>e3</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0xefe4966fa7747a84</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>e4</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0xac6a45cfcc93f053</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>from</span> <span style=color:#ca72ff>pwn</span> <span style=color:#76a9f9>import</span> <span style=color:#54b1c7>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ans1</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>e1</span> <span style=color:#54b1c7>^</span> <span style=color:#aa89ea>a</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>0</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ans2</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>e2</span> <span style=color:#54b1c7>^</span> <span style=color:#aa89ea>a</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>1</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ans3</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>e3</span> <span style=color:#54b1c7>^</span> <span style=color:#aa89ea>a</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>2</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ans4</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>e4</span> <span style=color:#54b1c7>^</span> <span style=color:#aa89ea>a</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>3</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>test</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>int</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>from_bytes</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>flag</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>0</span><span style=color:#abb2bf>:</span><span style=color:#d19a66>8</span><span style=color:#abb2bf>],</span> <span style=color:#63c381>&#34;little&#34;</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>^</span> <span style=color:#aa89ea>a</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>0</span><span style=color:#abb2bf>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;possible: </span><span style=color:#98c379>{</span><span style=color:#aa89ea>ans1</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;assume: </span><span style=color:#98c379>{</span><span style=color:#e5c07b>hex</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>test</span><span style=color:#abb2bf>)</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ans1</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ans1</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>to_bytes</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>8</span><span style=color:#abb2bf>,</span> <span style=color:#63c381>&#34;little&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;ans1: </span><span style=color:#98c379>{</span><span style=color:#aa89ea>ans1</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ans2</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ans2</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>to_bytes</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>8</span><span style=color:#abb2bf>,</span> <span style=color:#63c381>&#34;little&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;ans2: </span><span style=color:#98c379>{</span><span style=color:#aa89ea>ans2</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ans3</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ans3</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>to_bytes</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>8</span><span style=color:#abb2bf>,</span> <span style=color:#63c381>&#34;little&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;ans3: </span><span style=color:#98c379>{</span><span style=color:#aa89ea>ans3</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ans4</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ans4</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>to_bytes</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>8</span><span style=color:#abb2bf>,</span> <span style=color:#63c381>&#34;little&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>print</span><span style=color:#abb2bf>(</span><span style=color:#98c379>f</span><span style=color:#63c381>&#34;ans4: </span><span style=color:#98c379>{</span><span style=color:#aa89ea>ans4</span><span style=color:#98c379>}</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>)</span>
</span></span></code></pre></div><p>FLAG: <code>SECCON{y3t_4n0th3r_m0vfu5c4t0r?}</code></p><h2 id=crypto-dlp-40>Crypto: DLP 4.0
<a class=heading-link href=#crypto-dlp-40><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>この問題は考察パートのみ. 実装は同じチームの慈英さんが引き受けて下さった. 本当にありがとうございました.</p><p>333bit長の任意の素数 \(p\) をこちらから与えることができ, その上で, ランダムにとられた \(p^2-1\) 以下の十分大きい数 \(x\) と環 \(\mathbb{Z}_p\) での四元数 \(g\) について, \(g\) と \(g^x\) が与えられる. そこから \(g^x = g^{x&rsquo;}\) となる \(x&rsquo;\) を1つ与えると正答となる.</p><p>法を \(p\) としてノルムを考えると,
$$\|g\|_p^{x&rsquo;} \equiv \|g\|_p^x \mod p$$</p><p>今, \(\|g\|_p\) と \(\|g\|_p^x\)は, \(g\) と \(g^x\)からすぐ計算できるので, 離散対数問題に帰着できる. こちらで\(p\)を指定できるので, あとはPohlig–Hellmanアルゴリズムを使えば良い.</p><p>FLAG: 知らない</p><h2 id=まとめ>まとめ
<a class=heading-link href=#%e3%81%be%e3%81%a8%e3%82%81><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>運営の方, チームの方, 2日間ありがとうございました. もっと知識と技術をつけて出直してきます.</p><h2 id=おまけ-時間の使い方>(おまけ) 時間の使い方
<a class=heading-link href=#%e3%81%8a%e3%81%be%e3%81%91-%e6%99%82%e9%96%93%e3%81%ae%e4%bd%bf%e3%81%84%e6%96%b9><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>1日目はReMOVをとりあえず解いてから, babyheap1970(Pascalでのheap pwn)に手をつけて沼らせ, 2日目はほとんどの時間をbabyheap1970とbombermanを行ったり来たりして時間を溶かしていた. 他の多くのチームがDLP 4.0を解いていたので, 2日目の昼頃に"自分にも解けるやろ"くらいの軽い気持ちでDLP 4.0を考察し実装を慈英さんに丸投げした.</p></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme"),themeInParams="";getTheme==null&&(themeInParams!==""&&themeInParams!=="auto"?getTheme=themeInParams:getTheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","caphosra/caphosra.github.io"),s.setAttribute("issue-term","title"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container><p>Footer? なにそれ美味しいの?</p>© 2019 - 2024
caphosra</section></footer></main></body></html>